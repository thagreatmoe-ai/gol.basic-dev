/* ===========================
 GoL — Clean CSS (safe-area removed)
 Mobile-first, dark, glassy cards
=========================== */

/* -------- Tokens -------- */
:root{
  /* Theme */
  --bg:#0b0f1a;
  --panel:#12172a;
  --card:#18203a;
  --text:#f4f7ff;
  --muted:#a6b0d6;
  --accent:#7b8cff;
  --accent2:#38d39f;
  --danger:#ff6b6b;
  --border:#253055;

  /* Sizes */
  --tabbar-h:64px;   /* visible height of the bottom bar */
  --radius-lg:16px;  /* main card radius */
  --radius-md:12px;
}

/* -------- Base / layout -------- */
*{ box-sizing:border-box; }
html,body{ height:100%; }
html,body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;
  -webkit-font-smoothing:antialiased;
}
#app{ min-height:100vh; }

/* Page content leaves room only for the visible tab bar (no safe area) */
body{ padding-bottom:var(--tabbar-h); }

/* Prevent side scroll */
html, body, main, .view { overflow-x:hidden; }

/* -------- Top bar -------- */
.topbar{
  position:sticky; top:0; z-index:30;
  display:flex; align-items:center; gap:12px;
  padding:10px 12px;
  background:linear-gradient(180deg,var(--panel),rgba(18,23,42,.7));
  border-bottom:1px solid var(--border);
}
.topbar .top-title{ flex:1; }
.topbar .top-right{ display:flex; gap:6px; }

#hamburger{ background:transparent; border:none; color:var(--text); font-size:22px; }

/* -------- Drawer -------- */
#backdrop{ position:fixed; inset:0; background:rgba(0,0,0,.5); display:none; z-index:19; }
#drawer{
  position:fixed; z-index:20; top:0; left:0; bottom:0;
  width:80%; max-width:360px;
  background:var(--panel);
  border-right:1px solid var(--border);
  transform:translateX(-100%);
  transition:.25s transform ease;
  display:flex; flex-direction:column;
}
#drawer.open{ transform:translateX(0); }
.drawer-header{ display:flex; gap:12px; align-items:center; padding:16px; border-bottom:1px solid var(--border); }
.drawer-nav{ display:flex; flex-direction:column; padding:8px; }
.nav-item{ background:transparent; border:1px solid var(--border); color:var(--text); padding:12px; border-radius:12px; text-align:left; margin:6px 8px; }

/* -------- Chips / avatar -------- */
.chip{ background:var(--card); border:1px solid var(--border); border-radius:999px; padding:6px 10px; font-size:12px; }
.avatar{ width:40px; height:40px; border-radius:12px; background:linear-gradient(135deg,#6d77ff,#33d3a1); display:grid; place-items:center; font-weight:800; }
.avatar.big{ width:64px; height:64px; font-size:20px; }
.sub{ color:var(--muted); }
.small{ font-size:12px; }

/* -------- Cards / lists -------- */
main{ padding:12px; }
.view{ display:none; }
.view.active{ display:block; }

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius-lg);
  padding:12px;
  margin-bottom:12px;
  box-shadow:0 8px 24px rgba(0,0,0,.35);
}

/* Glass flavor for top cards */
.card.glass{
  background:rgba(16,24,52,.38);
  border:1px solid rgba(37,48,85,.6);
  backdrop-filter:blur(14px) saturate(1.05);
  -webkit-backdrop-filter:blur(14px) saturate(1.05);
}

.list{ display:flex; flex-direction:column; gap:8px; }

.item{
  display:flex; gap:8px; align-items:center;
  border:1px solid var(--border);
  background:var(--panel);
  border-radius:12px;
  padding:10px;
}

/* Progress bar */
.bar{
  height:10px;
  background:#0a0f1c;
  border:1px solid var(--border);
  border-radius:999px;
  overflow:hidden;
}
.fill{
  height:100%;
  background:linear-gradient(90deg,var(--accent),var(--accent2));
  width:0%;
  transition:width .25s ease;
}

/* Buttons / inputs */
.btn{ background:var(--accent); border:none; color:#fff; border-radius:12px; padding:10px 14px; font-weight:700; }
.btn.alt{ background:var(--panel); border:1px solid var(--border); color:var(--text); }
.btn.ghost{ background:transparent; border:1px dashed var(--border); color:var(--muted); }
.btn.danger{ background:var(--danger); }

.input{
  width:100%;
  background:#0b1022;
  color:var(--text);
  border:1px solid var(--border);
  border-radius:10px;
  padding:10px;
}

/* Tables */
.table{ width:100%; border-collapse:collapse; }
.table th,.table td{ border-bottom:1px solid var(--border); text-align:left; padding:8px; font-size:13px; }

/* -------- Top split (Resistance + Quick Session) -------- */
.top-split{
  display:grid;
  grid-template-columns:repeat(2, minmax(0,1fr));
  gap:12px;
  margin:12px 0;
}
@media (max-width:359px){
  .top-split{ grid-template-columns:1fr; }
}
#resistCard, #quickCard{ padding:12px; display:flex; flex-direction:column; gap:10px; }

/* iOS-style switch */
.switch{ position:relative; display:inline-block; width:52px; height:30px; }
.switch input{ display:none; }
.switch .slider{
  position:absolute; inset:0; border-radius:999px;
  background:#36405e; border:1px solid rgba(255,255,255,.08);
  transition:background .18s ease;
}
.switch .slider::before{
  content:""; position:absolute; top:3px; left:3px; width:24px; height:24px;
  background:#fff; border-radius:50%;
  box-shadow:0 2px 6px rgba(0,0,0,.35);
  transition:transform .18s ease;
}
.switch input:checked + .slider{ background:var(--accent); }
.switch input:checked + .slider::before{ transform:translateX(22px); }

/* -------- Today’s tasks (comfy tiles) -------- */
#todayTasks{ display:flex; flex-direction:column; gap:12px; }
#todayTasks .item{ padding:16px 18px; margin:6px 0; }
#todayTasks .bar{ height:6px; border-radius:999px; background:rgba(255,255,255,.06); }
#todayTasks .bar .fill{ background:var(--accent); }

/* -------- Sheet -------- */
.sheet{
  position:fixed; z-index:40; left:0; right:0; bottom:0;
  transform:translateY(100%);
  background:var(--panel);
  border-top:1px solid var(--border);
  border-radius:16px 16px 0 0;
  padding:12px;
  max-height:85vh;
  overflow:auto;
  transition:.25s transform;
}
.sheet.open{ transform:translateY(0); }

/* -------- Bottom tab bar (flush to bottom, no safe area) -------- */
#tabbar{
  position:fixed; z-index:25; left:0; right:0; bottom:0;
  height:var(--tabbar-h);
  display:flex; justify-content:space-around; align-items:center;
  background:rgba(18,23,42,.85);
  -webkit-backdrop-filter:blur(6px); backdrop-filter:blur(6px);
  border-top:1px solid var(--border);
  padding:0;                     /* no extra inner padding */
}
#tabbar::after{ content:none; }  /* make sure nothing paints a safe area */

#tabbar .tab{
  flex:1;
  background:transparent; border:none;
  color:var(--text); font-weight:700;
  min-height:44px;               /* nice tap target */
}
#tabbar .tab.active{ color:var(--accent); }

/* Floating + button sits just above the bar */
.fab{
  position:fixed; right:16px;
  bottom:calc(var(--tabbar-h) + 16px);
  width:56px; height:56px; border-radius:50%;
  display:none; align-items:center; justify-content:center;
  padding:0; line-height:1; font-size:28px; font-weight:700;
  background:linear-gradient(90deg,var(--accent),#9aa7ff);
  color:#0d1020; border:none;
  box-shadow:0 12px 30px rgba(0,0,0,.35);
}

/* -------- Grids / KPIs -------- */
.grid2{ display:grid; grid-template-columns:1fr; gap:12px; }
@media (min-width:900px){ .grid2{ grid-template-columns:1fr 1fr; } }

.kpis{ display:grid; grid-template-columns:repeat(4,1fr); gap:8px; }
.kpi{ font-size:22px; font-weight:800; }

/* -------- Optional background customization hook -------- */
:root{
  --bg-image:none;          /* e.g., url('…') set via JS */
  --bg-size:cover;
  --bg-pos:center center;
  --bg-attach:fixed;
}
body{
  background-image:var(--bg-image);
  background-size:var(--bg-size);
  background-position:var(--bg-pos);
  background-attachment:var(--bg-attach);
}

/* -------- Toast (unchanged) -------- */
#toast{
  position:fixed; left:50%; bottom:calc(var(--tabbar-h) + 12px);
  transform:translateX(-50%); background:rgba(28,36,64,.96);
  color:var(--text); padding:12px 16px; border:1px solid var(--border);
  border-radius:12px; box-shadow:0 12px 30px rgba(0,0,0,.35);
  font-size:14px; pointer-events:none; opacity:0;
  transition:opacity .18s ease, transform .18s ease; z-index:9998;
}
#toast.show{ opacity:1; transform:translateX(-50%) translateY(-4px); }

/* ===== End — no env(safe-area-*) anywhere ===== */
/* FIX PACK — header safe top (no layout changes elsewhere) */
.topbar{
  padding-top: calc(env(safe-area-inset-top) + 8px) !important;
  min-height: calc(44px + env(safe-area-inset-top)) !important;
}
/* make sure we didn’t also pad the page itself at the top */
body, #app, main, .view{ padding-top:0 !important; }
/* FIX PACK — compact, flush tab bar */
:root{ --tabbar-h: 56px; } /* only used here; keep your look */

#tabbar{
  position:fixed; left:0; right:0; bottom:0; z-index:25;
  height:var(--tabbar-h) !important;      /* visual height only */
  padding-bottom:0 !important;             /* don't grow for safe area */
  display:flex; justify-content:space-around; align-items:center;
  background:rgba(18,23,42,.85); backdrop-filter:blur(6px);
  border-top:1px solid var(--border);
  overflow:visible;                         /* allow ::after to paint below */
}

/* Paint the unsafe area below the bar so there's no visible gap */
#tabbar::after{
  content:""; position:absolute; left:0; right:0;
  bottom: calc(-1 * env(safe-area-inset-bottom));
  height: env(safe-area-inset-bottom);
  background: inherit; border-top: 1px solid var(--border);
  pointer-events: none;
}

/* Keep page content clear of the bar (only the bar height, not the safe area) */
#app{ padding-bottom: var(--tabbar-h) !important; }

/* Put icons *inside* the bar and normalize their size */
#tabbar .tab{
  flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center;
  height:var(--tabbar-h); min-width:64px; gap:4px; font-size:13px;
}
#tabbar .tab svg, #tabbar .tab img{ width:22px; height:22px; display:block; }
/* FIX PACK — bottom sheet breathing room */
.sheet{
  padding-bottom: max(16px, env(safe-area-inset-bottom) + 16px) !important;
}
/* FIX PACK — remove any decorative marker from the summary row */
#todayTasks .item .summary::before,
#todayTasks .item .summary::after{ content:none !important; }
#todayTasks .item .summary, #todayTasks .item .summary *{ outline:0 !important; }
/* =========================
   FIX PACK (drop-in overrides)
   ========================= */

/* 1) Header: avoid notch overlap */
.topbar{
  padding-top: calc(env(safe-area-inset-top) + 8px) !important;
  min-height: calc(44px + env(safe-area-inset-top)) !important;
}
body, #app, main, .view{ padding-top:0 !important; }

/* 2) Tab bar: icons inside, bar flush to bottom (no visible gap) */
:root{ --tabbar-h: 56px; }
#tabbar{
  position:fixed; left:0; right:0; bottom:0; z-index:25;
  height:var(--tabbar-h) !important;
  padding-bottom:0 !important;
  display:flex; justify-content:space-around; align-items:center;
  background:rgba(18,23,42,.85); backdrop-filter:blur(6px);
  border-top:1px solid var(--border);
  overflow:visible;
}
#tabbar::after{
  content:""; position:absolute; left:0; right:0;
  bottom: calc(-1 * env(safe-area-inset-bottom));
  height: env(safe-area-inset-bottom);
  background: inherit; border-top: 1px solid var(--border);
  pointer-events: none;
}
#app{ padding-bottom: var(--tabbar-h) !important; }
#tabbar .tab{
  flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center;
  height:var(--tabbar-h); min-width:64px; gap:4px; font-size:13px;
}
#tabbar .tab svg, #tabbar .tab img{ width:22px; height:22px; display:block; }

/* 3) Bottom sheet: keep controls above home indicator */
.sheet{
  padding-bottom: max(16px, env(safe-area-inset-bottom) + 16px) !important;
}

/* 4) Cosmetic: remove stray marker in task summary row */
#todayTasks .item .summary::before,
#todayTasks .item .summary::after{ content:none !important; }
/* ---- Force tab bar flush to device bottom (no visible safe-area gap) ---- */
:root{ --tabbar-h:64px; } /* keep your current visual height */

body{ padding-bottom:var(--tabbar-h) !important; }  /* content reserves only the bar's height */

#tabbar{
  height:var(--tabbar-h) !important;
  padding-bottom:0 !important;
  bottom:0 !important;
}
/* ---- Icons-only tabs (hide the label text) ---- */
#tabbar .tab > span{ display:none !important; }
#tabbar .tab svg{ width:22px; height:22px; }  /* keep icons clear */
#todayTasks .item .summary, #todayTasks .item .summary *{ outline:0 !important; }
/* ---- Keep the FAB hovering just above the bar ---- */
.fab{ bottom:calc(var(--tabbar-h) + 16px) !important; }
/* ---- Make the big Today card translucent to match top cards ---- */
#view-today > .card{
  background:rgba(16,24,52,.38) !important;
  border:1px solid rgba(34,48,87,.55) !important;
  backdrop-filter:blur(14px) saturate(1.1);
  -webkit-backdrop-filter:blur(14px) saturate(1.1);
}
/* ---- Slim XP ribbon under the header ---- */
#xpRibbon, #xpStrip{
  height:8px; margin:6px 16px 8px; border-radius:999px;
  background:rgba(255,255,255,.08); overflow:hidden;
}
#xpRibbon .fill, #xpStrip .fill{
  height:100%; width:0%; transition:width .3s ease;
  background:linear-gradient(90deg,var(--accent,#7b8cff), #9aa7ff);
}
/* keep the gap tight before the top split */
#xpRibbon + .top-split, #xpStrip + .top-split{ margin-top:8px; }
/* ---- Task tiles: accent spine on the left ---- */
#todayTasks .item{ position:relative; overflow:hidden; }
#todayTasks .item::before{
  content:""; position:absolute; top:0; bottom:0; left:0; width:4px;
  background:linear-gradient(180deg, var(--accent,#7b8cff), #9aa7ff);
  opacity:.8;
}
/* ---- Drawer should cover content; hamburger stays visible ---- */
#hamburger{ width:48px; height:48px; display:grid; place-items:center; }
.ham{ width:22px; height:2px; background:var(--text); position:relative; display:block; }
.ham::before,.ham::after{ content:""; position:absolute; left:0; right:0; height:2px; background:var(--text); }
.ham::before{ top:-6px; } .ham::after{ top:6px; }

#backdrop{ position:fixed; inset:0; background:rgba(0,0,0,.5); z-index:998 !important; display:none; }
#drawer{ position:fixed; top:0; left:0; bottom:0; width:80%; max-width:360px;
  background:var(--panel); border-right:1px solid var(--border);
  transform:translateX(-100%); transition:.25s; z-index:999 !important;
}
#drawer.open{ transform:translateX(0); }